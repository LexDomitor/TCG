<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Life Counter</title>
<style>
body { margin:0; font-family:sans-serif; background:#111; color:white; display:flex; flex-direction:column; height:100vh; align-items:center;}
.info-bar { background:#444; padding:5px 10px; font-size:0.9rem; display:flex; justify-content:space-between; width:100%; box-sizing:border-box; }
.life-wrapper { display:flex; width:90%; gap:10px; margin-top:10px; justify-content:center; align-items:flex-start; }
.player-container { flex:1; display:flex; flex-direction:column; align-items:center; min-width:120px; }
.bar-container { position:relative; width:100%; flex:1; border:5px solid black; display:flex; flex-direction:column; justify-content:flex-end; min-height:300px; box-sizing:border-box; overflow:hidden; }
.life-bar { position:absolute; bottom:0; width:100%; z-index:2; transition:height 0.2s ease; }
.trail-bar { position:absolute; bottom:0; width:100%; background:white; z-index:1; transition:height 0.5s ease; }
.player-number { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-size:3rem; font-weight:bold; z-index:3; pointer-events:none; color:white; }
.control-panel { display:flex; justify-content:center; align-items:center; gap:8px; margin-top:10px; z-index:4; }
input[type=number] { width:60px; text-align:center; border-radius:4px; border:none; }
.btn { padding:10px 20px; border:none; border-radius:6px; color:white; font-weight:bold; cursor:pointer; font-size:1rem; }
.blue { background:#3b82f6; } .green { background:#22c55e; } .red { background:#ff3b3b; } 
.reset-btn { background:#888; margin-top:5px; display:none; }
</style>
</head>
<body>

<div class="info-bar">
  <span id="lastUpdated"></span>
  <span id="userDateTime"></span>
</div>

<div class="life-wrapper">
  <div class="player-container">
    <div class="bar-container" id="containerA">
      <div class="trail-bar" id="trailA"></div>
      <div class="life-bar" id="barA" style="background:green;"></div>
      <div class="player-number" id="lifeA">20</div>
    </div>
    <div class="control-panel">
      <button class="btn green" onclick="adjustLife('A','subtract')">-</button>
      <input type="number" id="adjustAmountA" value="1" min="1">
      <button class="btn blue" onclick="adjustLife('A','add')">+</button>
    </div>
    <button class="btn reset-btn" id="resetA" onclick="resetLife('A')">Reset</button>
  </div>

  <div class="player-container">
    <div class="bar-container" id="containerB">
      <div class="trail-bar" id="trailB"></div>
      <div class="life-bar" id="barB" style="background:green;"></div>
      <div class="player-number" id="lifeB">20</div>
    </div>
    <div class="control-panel">
      <button class="btn green" onclick="adjustLife('B','subtract')">-</button>
      <input type="number" id="adjustAmountB" value="1" min="1">
      <button class="btn blue" onclick="adjustLife('B','add')">+</button>
    </div>
    <button class="btn reset-btn" id="resetB" onclick="resetLife('B')">Reset</button>
  </div>
</div>

<script>
let lifeTotals = {A:20,B:20};
let maxLife = {A:20,B:20};

function adjustLife(player,action){
  const amt = parseInt(document.getElementById('adjustAmount'+player).value)||1;
  lifeTotals[player] += (action==='add'?amt:-amt);
  updateLifeDisplay(player);
}

function resetLife(player){
  lifeTotals[player] = maxLife[player];
  updateLifeDisplay(player);
}

function updateLifeDisplay(player){
  const bar = document.getElementById('bar'+player);
  const trail = document.getElementById('trail'+player);
  const resetBtn = document.getElementById('reset'+player);
  let life = lifeTotals[player];

  // Clamp life
  if(life > maxLife[player]) life = maxLife[player];
  if(life < 0) life = 0;

  const percentage = life / maxLife[player];
  bar.style.height = (percentage*100)+'%';

  const ratio = life / maxLife[player];
  bar.style.background = ratio <= 0.25 ? 'red' : ratio <= 0.75 ? 'goldenrod' : 'green';
  document.getElementById('life'+player).textContent = lifeTotals[player];

  // Show reset button if life <=0
  resetBtn.style.display = (lifeTotals[player] <= 0) ? 'block' : 'none';

  // Animate trail bar (pure white)
  if(trail.animation) clearInterval(trail.animation);
  trail.animation = setInterval(()=>{
    let current = parseFloat(trail.style.height || '100') / 100;
    if(current > percentage){ current -= 0.02; if(current <= percentage){ current = percentage; clearInterval(trail.animation); }}
    else if(current < percentage){ current += 0.02; if(current >= percentage){ current = percentage; clearInterval(trail.animation); }}
    trail.style.height = (current*100)+'%';
  },15);
}

// Initialize
document.getElementById('trailA').style.height='100%';
document.getElementById('trailB').style.height='100%';
updateLifeDisplay('A');
updateLifeDisplay('B');

// Date formatting with AM/PM
function getDateSuffix(day){
  if(day>=11 && day<=13) return 'th';
  switch(day%10){ case 1: return 'st'; case 2: return 'nd'; case 3: return 'rd'; default: return 'th'; }
}

function updateDateTime(){
  const now = new Date();
  const pstOffset = -7;
  const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
  const pstTime = new Date(utc + (3600000 * pstOffset));

  const months = ["January","February","March","April","May","June","July","August","September","October","November","December"];
  const month = months[pstTime.getMonth()];
  const day = pstTime.getDate();
  const suffix = getDateSuffix(day);
  const year = pstTime.getFullYear();

  let hours = pstTime.getHours();
  const minutes = String(pstTime.getMinutes()).padStart(2,'0');
  const seconds = String(pstTime.getSeconds()).padStart(2,'0');
  const ampm = hours>=12?'PM':'AM';
  hours = hours%12; if(hours===0) hours=12;
  const hoursStr = String(hours).padStart(2,'0');

  document.getElementById('lastUpdated').textContent = `Last Updated: ${hoursStr}:${minutes}:${seconds} ${ampm} PST`;
  document.getElementById('userDateTime').textContent = `User Date: ${month} ${day}${suffix}, ${year} | User Time: ${hoursStr}:${minutes}:${seconds} ${ampm}`;
}

setInterval(updateDateTime,1000);
updateDateTime();
</script>

</body>
</html>
