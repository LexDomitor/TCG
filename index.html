<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MTG Tools</title>
  <style>
    body { font-family: sans-serif; margin: 0; display: flex; flex-direction: column; min-height: 100vh; background: #111; color: white; overflow: hidden; }
    .timestamp { position: absolute; top: 5px; left: 10px; font-size: 0.8rem; color: #888; line-height: 1.2; z-index: 10; }
    .hidden { display: none; }
    .btn { padding: 8px 16px; border-radius: 8px; color: white; text-decoration: none; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.3); cursor: pointer; border: none; z-index: 10; position: relative; }
    .blue { background: #3b82f6; }
    .blue:hover { background: #2563eb; }
    .green { background: #22c55e; }
    .green:hover { background: #16a34a; }
    h1, h2 { margin: 0; }
    .nav { cursor: pointer; text-decoration: underline; }

    /* Toolbar */
    .toolbar { display: flex; justify-content: center; align-items: center; padding: 10px; background: #222; position: relative; z-index: 10; }
    select, input[type='number'] { padding: 4px 8px; font-size: 1rem; }

    /* Player layout */
    .life-wrapper { display: flex; flex: 1; }
    .player { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; overflow: hidden; }

    /* Resizable life bar container */
    .life-bar-container {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      border: 5px solid black;
      box-sizing: border-box;
      overflow: hidden;
      min-width: 120px;
      min-height: 80px;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 0;
    }

    .life-fill-back {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      background: rgba(255,255,255,0.1);
      z-index: 0;
      transition: height 0.5s ease;
    }

    .life-bar {
      width: 100%;
      height: 100%;
      transition: background 0.5s ease;
    }

    .player-name { font-size: 1.2rem; margin-bottom: 10px; z-index: 2; position: relative; }
    .life-display { font-size: 4rem; font-weight: bold; color: white; z-index: 2; position: relative; transition: transform 0.2s ease; }
    .life-animate { transform: scale(1.2); }

    /* Control positioning */
    .control-panel { display: flex; gap: 8px; margin-top: 10px; align-items: center; z-index: 2; position: relative; }
    .player-controls-left { flex-direction: row; }
    .player-controls-right { flex-direction: row-reverse; }

    /* Splash animation */
    @keyframes splash {
      0% { transform: scaleY(1); opacity: 1; }
      50% { transform: scaleY(1.5); opacity: 0.7; }
      100% { transform: scaleY(1); opacity: 0; }
    }
    .splash-effect { animation: splash 0.5s ease forwards; }

    /* Resize handle */
    .resize-handle {
      width: 16px;
      height: 16px;
      background: black;
      position: absolute;
      right: 0;
      bottom: 0;
      cursor: nwse-resize;
      z-index: 5;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div id="home">
    <h1 style="text-align:center; margin: 20px 0;">MTG Tools</h1>
    <div style="display:flex; flex-direction:column; align-items:center; gap: 10px;">
      <button class="btn blue" onclick="showPage('lifeCounter')">MTG Life Counter</button>
      <button class="btn green" onclick="showPage('archnemesis')">MTG Archnemesis</button>
    </div>
  </div>

  <div id="lifeCounter" class="hidden" style="flex:1; display:flex; flex-direction:column;">
    <div class="toolbar">
      <div class="timestamp">
        Last Updated: 2025-09-14 22:50 PST<br>
        <span id="userTime">User Time: --:--</span>
      </div>
      <div>
        <label for="presetSelect">Preset: </label>
        <select id="presetSelect" onchange="updatePreset()">
          <option value="standard" selected>STANDARD (20)</option>
          <option value="commander">COMMANDER (40)</option>
          <option value="custom">CUSTOM</option>
        </select>
        <input id="customLifeInput" type="number" min="1" placeholder="Custom Life" class="hidden" onchange="setCustomLife()">
      </div>
      <button class="btn blue" onclick="showPage('home')">Home</button>
    </div>

    <div class="life-wrapper">
      <div class="player" id="playerA">
        <div class="life-bar-container" id="containerA">
          <div class="life-fill-back" id="fillBackA"></div>
          <div class="life-bar" id="barA"></div>
        </div>
        <div class="player-name">Player A</div>
        <div class="life-display" id="lifeA">20</div>
        <div class="control-panel player-controls-left">
          <button class="btn blue" onclick="adjustLife('A','add')">+</button>
          <button class="btn green" onclick="adjustLife('A','subtract')">-</button>
          <input id="adjustAmountA" type="number" value="1" min="1">
        </div>
      </div>

      <div class="player" id="playerB">
        <div class="life-bar-container" id="containerB">
          <div class="life-fill-back" id="fillBackB"></div>
          <div class="life-bar" id="barB"></div>
        </div>
        <div class="player-name">Player B</div>
        <div class="life-display" id="lifeB">20</div>
        <div class="control-panel player-controls-right">
          <button class="btn blue" onclick="adjustLife('B','add')">+</button>
          <button class="btn green" onclick="adjustLife('B','subtract')">-</button>
          <input id="adjustAmountB" type="number" value="1" min="1">
        </div>
      </div>
    </div>
  </div>

  <div id="archnemesis" class="hidden">
    <h2>MTG Archnemesis</h2>
    <div class="nav" onclick="showPage('home')">Back to Home</div>
  </div>

  <script>
    let lifeTotals = { A: 20, B: 20 };
    let maxLife = 20;

    function showPage(page) {
      document.querySelectorAll('body > div').forEach(div => div.classList.add('hidden'));
      document.getElementById(page).classList.remove('hidden');
    }

    function updateLifeDisplay(player) {
      const lifeDisplay = document.getElementById('life' + player);
      const lifeBar = document.getElementById('bar' + player);
      const fillBack = document.getElementById('fillBack' + player);
      const total = lifeTotals[player];
      lifeDisplay.textContent = total;

      const percentage = total / maxLife;
      fillBack.style.height = (percentage * 100) + '%';

      lifeBar.style.background = percentage <= 0.25 ? 'red' : percentage <= 0.75 ? 'goldenrod' : 'green';

      if (total <= 0) {
        lifeBar.classList.add('splash-effect');
        setTimeout(() => lifeBar.classList.remove('splash-effect'), 500);
      }

      lifeDisplay.classList.add('life-animate');
      setTimeout(() => lifeDisplay.classList.remove('life-animate'), 150);
    }

    function adjustLife(player, action) {
      const amount = parseInt(document.getElementById('adjustAmount' + player).value) || 1;
      if (action === 'add') lifeTotals[player] += amount;
      else if (action === 'subtract') lifeTotals[player] -= amount;
      updateLifeDisplay(player);
    }

    function updatePreset() {
      const preset = document.getElementById('presetSelect').value;
      const customInput = document.getElementById('customLifeInput');
      if (preset === 'standard') {
        customInput.classList.add('hidden');
        maxLife = 20;
        lifeTotals.A = lifeTotals.B = 20;
      } else if (preset === 'commander') {
        customInput.classList.add('hidden');
        maxLife = 40;
        lifeTotals.A = lifeTotals.B = 40;
      } else {
        customInput.classList.remove('hidden');
        customInput.focus();
      }
      updateLifeDisplay('A');
      updateLifeDisplay('B');
    }

    function setCustomLife() {
      const customValue = parseInt(document.getElementById('customLifeInput').value);
      if (!isNaN(customValue) && customValue > 0) {
        maxLife = customValue;
        lifeTotals.A = lifeTotals.B = customValue;
        updateLifeDisplay('A');
        updateLifeDisplay('B');
      }
    }

    function updateUserTime() {
      const now = new Date();
      const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
      document.getElementById('userTime').textContent = `User Time: ${timeString}`;
    }

    // Global drag handle for resizing both players
    let isResizing = false;
    const handle = document.createElement('div');
    handle.className = 'resize-handle';
    document.getElementById('containerA').appendChild(handle);

    handle.addEventListener('mousedown', (e) => { isResizing = true; e.preventDefault(); });

    document.addEventListener('mousemove', (e) => {
      if (!isResizing) return;
      const containerA = document.getElementById('containerA');
      const containerB = document.getElementById('containerB');
      let newWidth = e.clientX - containerA.getBoundingClientRect().left;
      let newHeight = e.clientY - containerA.getBoundingClientRect().top;
      newWidth = Math.max(newWidth, 120);
      newHeight = Math.max(newHeight, 80);
      containerA.style.width = newWidth + 'px';
      containerA.style.height = newHeight + 'px';
      containerB.style.width = newWidth + 'px';
      containerB.style.height = newHeight + 'px';
    });

    document.addEventListener('mouseup', () => { isResizing = false; });

    updateLifeDisplay('A');
    updateLifeDisplay('B');
    updateUserTime();
    setInterval(updateUserTime, 60000);
  </script>
</body>
</html>
